{"ast":null,"code":"import { getToken } from '@/utils/auth';\nexport default {\n  name: \"PictureView\",\n  data() {\n    return {\n      tableData: [],\n      total: 0,\n      pageNum: 1,\n      pageSize: 5,\n      filename: \"\",\n      token: {\n        Authorization: getToken()\n      },\n      form: {},\n      multipleSelection: []\n    };\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    load() {\n      this.axios.get(\"/file/page\", {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.tableData = result.data.page;\n          this.total = result.data.total;\n        } else {\n          this.$message.error(result.msg);\n        }\n      });\n    },\n    search() {\n      this.axios.get(\"/file/find\", {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          filename: this.filename\n        }\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.tableData = result.data.page;\n          this.total = result.data.total;\n        } else {\n          this.$message.error(result.msg);\n        }\n      });\n    },\n    reset() {\n      this.total = 0;\n      this.pageNum = 1;\n      this.pageSize = 5;\n      this.filename = \"\";\n      this.load();\n    },\n    handleFileUploadSuccess(res) {\n      if (res.code === 'C200') {\n        this.$message.success(\"保存成功\");\n        this.load();\n      } else {\n        this.$message.error(\"保存失败\");\n      }\n    },\n    delBatch() {\n      let ids = this.multipleSelection.map(v => v.id);\n      this.axios.post(\"/file/batchDelete\", ids).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.$message.success(\"批量删除成功\");\n          this.load();\n        } else {\n          this.$message.error(\"批量删除失败\");\n        }\n      });\n    },\n    download(url) {\n      window.open(url);\n    },\n    enable(file) {\n      this.axios.post(\"/file/enable\", file).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.$message.success(\"更新成功\");\n          this.load();\n        } else {\n          this.$message.error(\"更新失败\");\n        }\n      });\n    },\n    handleDelete(id) {\n      this.axios.delete(\"/file/delete\", {\n        params: {\n          id: id\n        }\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.$message.success(\"删除成功\");\n          this.load();\n        } else {\n          this.$message.error(\"删除失败\");\n        }\n      });\n    },\n    handleSelectionChange(val) {\n      this.multipleSelection = val;\n    },\n    handleSizeChange(pageSize) {\n      this.pageSize = pageSize;\n      this.load();\n    },\n    handleCurrentChange(pageNum) {\n      this.pageNum = pageNum;\n      this.load();\n    }\n  }\n};","map":{"version":3,"names":["getToken","name","data","tableData","total","pageNum","pageSize","filename","token","Authorization","form","multipleSelection","created","load","methods","axios","get","params","then","res","result","code","page","$message","error","msg","search","reset","handleFileUploadSuccess","success","delBatch","ids","map","v","id","post","download","url","window","open","enable","file","handleDelete","delete","handleSelectionChange","val","handleSizeChange","handleCurrentChange"],"sources":["src/views/fileview/PictureView.vue"],"sourcesContent":["<template>\n  <div>\n    <div style=\"margin: 10px 0\">\n      <el-input style=\"width: 200px; margin-left: 5px\" suffix-icon=\"el-icon-search\" placeholder=\"请输入图片名\" v-model=\"filename\"></el-input>\n      <el-button style=\"margin-left: 5px\" type=\"primary\" @click=\"search\">搜索</el-button>\n      <el-button style=\"margin-left: 5px\" type=\"warning\" @click=\"reset\">重置</el-button>\n      <el-upload action=\"http://localhost:9090/file/upload\" :headers=\"token\" style=\"display: inline-block\" :show-file-list=\"false\" accept=\"xlsx\" :on-success=\"handleFileUploadSuccess\">\n        <el-button style=\"margin-left: 5px\" type=\"primary\">上传图片<i class=\"el-icon-top\" style=\"margin-left: 5px\"></i></el-button>\n      </el-upload>\n      <el-popconfirm\n          confirm-button-text='好的'\n          cancel-button-text='不用了'\n          icon=\"el-icon-info\"\n          icon-color=\"red\"\n          title=\"确定批量删除吗？\"\n          @confirm=\"delBatch\">\n        <el-button style=\"margin-left: 5px\" type=\"danger\" slot=\"reference\">批量删除<i class=\"el-icon-remove-outline\" style=\"margin-left: 5px\"></i></el-button>\n      </el-popconfirm>\n    </div>\n    <el-table \n        :data=\"tableData\"\n        height=\"60vh\"\n        style=\"width: 100%; border-radius: 10px\"\n        @selection-change=\"handleSelectionChange\">\n      <el-table-column type=\"selection\" width=\"55\"></el-table-column>\n      <el-table-column prop=\"url\" label=\"预览\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <el-image style=\"width: 100px; height: 100px\" :src=\"scope.row.url\" fit=\"fit\"></el-image>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"fileName\" label=\"图片名\" width=\"140\">\n      </el-table-column>\n      <el-table-column prop=\"type\" label=\"图片类型\" width=\"140\">\n      </el-table-column>\n      <el-table-column prop=\"size\" label=\"图片大小(kb)\" width=\"140\">\n      </el-table-column>\n      <el-table-column prop=\"url\" label=\"下载\" width=\"140\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"primary\" @click=\"download(scope.row.url)\">下载</el-button>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"enable\" label=\"启用\" align=\"center\">\n        <template slot-scope=\"scope\">\n            <el-switch v-model=\"scope.row.enable\" active-color=\"#13ce66\" inactive-color=\"#ccc\" @change=\"enable(scope.row)\"></el-switch>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"option\" label=\"操作\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <el-popconfirm\n              confirm-button-text='好的'\n              cancel-button-text='不用了'\n              icon=\"el-icon-info\"\n              icon-color=\"red\"\n              title=\"确定删除吗？\"\n              @confirm=\"handleDelete(scope.row.id)\">\n            <el-button type=\"danger\" slot=\"reference\" style=\"margin-left: 5px\">删除<i class=\"el-icon-delete\" style=\"margin-left: 5px\"></i></el-button>\n          </el-popconfirm>\n        </template>\n      </el-table-column>\n    </el-table>\n    <div style=\"padding: 10px 0\">\n      <el-pagination\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n          :current-page=\"pageNum\"\n          :page-sizes=\"[2, 5, 10, 15]\"\n          :page-size=\"pageSize\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"total\">\n      </el-pagination>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { getToken } from '@/utils/auth';\nexport default {\n  name: \"PictureView\",\n  data() {\n    return {\n      tableData: [],\n      total: 0,\n      pageNum: 1,\n      pageSize: 5,\n      filename: \"\",\n      token: {\n        Authorization: getToken()\n      },\n      form: {},\n      multipleSelection: []\n    }\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    load() {\n      this.axios.get(\"/file/page\", {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.tableData = result.data.page;\n          this.total = result.data.total;\n        } else {\n          this.$message.error(result.msg);\n        }\n      })\n    },\n    search() {\n      this.axios.get(\"/file/find\", {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          filename: this.filename\n        }\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.tableData = result.data.page;\n          this.total = result.data.total;\n        } else {\n          this.$message.error(result.msg);\n        }\n      })\n    },\n    reset() {\n      this.total = 0;\n      this.pageNum = 1;\n      this.pageSize = 5;\n      this.filename = \"\";\n      this.load();\n    },\n    handleFileUploadSuccess(res) {\n      if (res.code === 'C200') {\n        this.$message.success(\"保存成功\");\n        this.load();\n      } else {\n        this.$message.error(\"保存失败\");\n      }\n    },\n    delBatch() {\n      let ids = this.multipleSelection.map(v => v.id);\n      this.axios.post(\"/file/batchDelete\", ids).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.$message.success(\"批量删除成功\");\n          this.load();\n        } else {\n          this.$message.error(\"批量删除失败\");\n        }\n      })\n    },\n    download(url) {\n      window.open(url);\n    },\n    enable(file) {\n      this.axios.post(\"/file/enable\", file).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.$message.success(\"更新成功\");\n          this.load();\n        } else {\n          this.$message.error(\"更新失败\");\n        }\n      })\n    },\n    handleDelete(id) {\n      this.axios.delete(\"/file/delete\", {\n        params: {\n          id: id\n        }\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.$message.success(\"删除成功\");\n          this.load();\n        } else {\n          this.$message.error(\"删除失败\");\n        }\n      })\n    },\n    handleSelectionChange(val) {\n      this.multipleSelection = val;\n    },\n    handleSizeChange(pageSize) {\n      this.pageSize = pageSize;\n      this.load();\n    },\n    handleCurrentChange(pageNum) {\n      this.pageNum = pageNum;\n      this.load();\n    }\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}