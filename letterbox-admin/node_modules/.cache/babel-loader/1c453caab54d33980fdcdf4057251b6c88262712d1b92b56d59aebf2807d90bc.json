{"ast":null,"code":"import { getToken } from '@/utils/auth';\nexport default {\n  name: \"TextView\",\n  data() {\n    return {\n      username: \"\",\n      tableData: [],\n      pageNum: 1,\n      pageSize: 10,\n      total: 0,\n      textDialogVisible: false,\n      loading: false,\n      formDialogVisible: false,\n      timer: null,\n      letter: {},\n      token: {\n        Authorization: getToken()\n      },\n      form: {\n        status: 2\n      }\n    };\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    load() {\n      this.axios.get(\"/letter/page\", {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.tableData = result.data.page;\n          this.total = result.data.total;\n        } else {\n          this.$message.error(result.msg);\n        }\n      });\n    },\n    search() {\n      this.axios.get(\"/letter/page\", {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          username: this.username\n        }\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.tableData = result.data.page;\n          this.total = result.data.total;\n        } else {\n          this.$message.error(result.msg);\n        }\n      });\n    },\n    reset() {\n      this.username = \"\";\n      this.total = 0;\n      this.pageNum = 1;\n      this.pageSize = 10;\n      this.load();\n    },\n    newLetter() {\n      this.formDialogVisible = true;\n    },\n    handleView(data) {\n      this.textDialogVisible = true;\n      this.letter = data;\n    },\n    download(url) {\n      window.open(url);\n    },\n    handleSizeChange(pageSize) {\n      this.pageSize = pageSize;\n      this.load();\n    },\n    handleCurrentChange(pageNum) {\n      this.pageNum = pageNum;\n      this.load();\n    },\n    handleClose() {\n      if (this.loading) {\n        return;\n      }\n      this.$confirm('确定要提交表单吗？').then(_ => {\n        this.loading = true;\n        this.axios.post(\"/letter/add\", this.form).then(res => {\n          let result = res.data;\n          if (result.code === 'C200') {\n            this.$message.success(\"添加成功\");\n            this.load();\n          } else {\n            this.$message.error(result.msg);\n          }\n        });\n        this.timer = setTimeout(() => {\n          // 动画关闭需要一定的时间\n          setTimeout(() => {\n            this.loading = false;\n          }, 400);\n        }, 2000);\n        this.formDialogVisible = false;\n      }).catch(_ => {});\n    },\n    cancelForm() {\n      this.loading = false;\n      this.formDialogVisible = false;\n      clearTimeout(this.timer);\n    }\n  }\n};","map":{"version":3,"names":["getToken","name","data","username","tableData","pageNum","pageSize","total","textDialogVisible","loading","formDialogVisible","timer","letter","token","Authorization","form","status","created","load","methods","axios","get","params","then","res","result","code","page","$message","error","msg","search","reset","newLetter","handleView","download","url","window","open","handleSizeChange","handleCurrentChange","handleClose","$confirm","_","post","success","setTimeout","catch","cancelForm","clearTimeout"],"sources":["src/views/fileview/TextView.vue"],"sourcesContent":["<template>\n  <div>\n    <div style=\"margin: 5px 0px 10px 0;\">\n      <el-input style=\"width: 200px; margin-left: 5px\" suffix-icon=\"el-icon-search\" placeholder=\"请输入用户名\" v-model=\"username\"></el-input>\n      <el-button style=\"margin-left: 5px\" type=\"primary\" @click=\"search\">搜索</el-button>\n      <el-button style=\"margin-left: 5px\" type=\"warning\" @click=\"reset\">重置</el-button>\n      <el-button style=\"margin-left: 5px\" type=\"primary\" @click=\"newLetter\">新建</el-button>\n    </div>\n    <el-table\n    :data=\"tableData\"\n    :default-sort = \"{prop: 'date', order: 'descending'}\"\n    height=\"60vh\"\n    style=\"width: 100%; border-radius: 10px\">\n      <el-table-column prop=\"date\" label=\"日期\" fixed=\"left\" sortable width=\"100\" align=\"center\"></el-table-column>\n      <el-table-column label=\"配送信息\" align=\"center\">\n        <el-table-column prop=\"username\" label=\"作者\" width=\"60\" align=\"center\"></el-table-column>\n        <el-table-column prop=\"callPhone\" label=\"电话\" width=\"100\" align=\"center\"></el-table-column>\n        <el-table-column prop=\"receiver\" label=\"收件方\" width=\"60\" align=\"center\"></el-table-column>\n        <el-table-column prop=\"receiverPhone\" label=\"收件电话\" width=\"100\" align=\"center\"></el-table-column>\n        <el-table-column label=\"地址配置\" align=\"center\">\n          <el-table-column prop=\"fromAddress\" label=\"源地址\" width=\"300\"></el-table-column>\n          <el-table-column prop=\"toAddress\" label=\"目的地址\" width=\"300\"></el-table-column>\n          <el-table-column prop=\"postalCode\" label=\"邮编\" width=\"120\" align=\"center\"></el-table-column>\n        </el-table-column>\n      </el-table-column>\n      <el-table-column label=\"配置内容\" align=\"center\">\n        <el-table-column label=\"信纸\" align=\"center\">\n          <template slot-scope=\"scope\">\n            <el-tag type=\"info\">{{ scope.row.goods[0].detail }}</el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"信封\" align=\"center\">\n          <template slot-scope=\"scope\">\n            <el-tag type=\"info\">{{ scope.row.goods[1].detail }}</el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"inkId\" label=\"字体\" align=\"center\">\n          <template slot-scope=\"scope\">\n            <el-tag type=\"info\">{{ scope.row.goods[2].detail }}</el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"内容\" align=\"center\">\n          <template slot-scope=\"scope\">\n            <el-button type=\"text\" @click=\"handleView(scope.row)\">预览</el-button>\n          </template>\n        </el-table-column>\n      </el-table-column>\n      <el-table-column label=\"状态\" fixed=\"right\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <div v-if=\"scope.row.status==0\">\n            <el-tag type=\"info\">未支付</el-tag>\n          </div>\n          <div v-else-if=\"scope.row.status===1\">\n            <el-tag type=\"info\">已支付</el-tag>\n          </div>\n          <div v-else-if=\"scope.row.status===2\">\n            <el-tag type=\"info\">未发出</el-tag>\n          </div>\n          <div v-else-if=\"scope.row.status===3\">\n            <el-tag type=\"info\">已发出</el-tag>\n          </div>\n          <div v-else-if=\"scope.row.status===4\">\n            <el-tag type=\"info\">已退回</el-tag>\n          </div>\n          <div v-else-if=\"scope.row.status===5\">\n            <el-tag type=\"info\">已收到</el-tag>\n          </div>\n          <div v-else>\n            <el-tag type=\"info\">none</el-tag>\n          </div>\n        </template>\n      </el-table-column>\n    </el-table>\n    <div style=\"padding: 10px 0; margin-top: 10px;\">\n      <el-pagination\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n          :current-page=\"pageNum\"\n          :page-sizes=\"[2, 5, 10, 15]\"\n          :page-size=\"pageSize\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"total\">\n      </el-pagination>\n    </div>\n    <el-dialog\n        title=\"预览\"\n        :visible.sync=\"textDialogVisible\"\n        width=\"40%\"\n        top=\"5vh\"\n        center>\n      <el-descriptions title=\"信件\" class=\"margin-top\" :column=\"3\" size=\"mini\" border>\n        <el-descriptions-item label=\"用户名\">{{ letter.username }}</el-descriptions-item>\n        <el-descriptions-item label=\"联系方式\">{{ letter.callPhone }}</el-descriptions-item>\n        <el-descriptions-item label=\"收件方\">{{ letter.receiver }}</el-descriptions-item>\n        <el-descriptions-item label=\"收件电话\">{{ letter.receiverPhone }}</el-descriptions-item>\n        <el-descriptions-item label=\"源地址\">{{ letter.fromAddress }}</el-descriptions-item>\n        <el-descriptions-item label=\"目的地址\">{{ letter.toAddress }}</el-descriptions-item>\n        <el-descriptions-item label=\"邮编\">{{ letter.postalCode }}</el-descriptions-item>\n      </el-descriptions>\n      <el-divider>内容</el-divider>\n      <div v-if=\"letter.inkId===13\">\n        <span class=\"zh_CN_1\">{{ letter.context }}</span>\n      </div>\n      <div v-else-if=\"letter.inkId===14\">\n        <span class=\"zh_CN_2\">{{ letter.context }}</span>\n      </div>\n      <div v-else-if=\"letter.inkId===15\">\n        <span class=\"zh_CN_3\">{{ letter.context }}</span>\n      </div>\n      <div v-else-if=\"letter.inkId===16\">\n        <span class=\"en_US_4\">{{ letter.context }}</span>\n      </div>\n      <div v-else-if=\"letter.inkId===17\">\n        <span class=\"en_US_5\">{{ letter.context }}</span>\n      </div>\n      <div v-else-if=\"letter.inkId===18\">\n        <span class=\"en_US_6\">{{ letter.context }}</span>\n      </div>\n      <div v-else>\n        <span>{{ letter.context }}</span>\n      </div>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"download(letter.url)\">下 载</el-button>\n        <el-button type=\"primary\" @click=\"textDialogVisible = false\">关 闭</el-button>\n      </span>\n    </el-dialog>\n    <el-drawer\n    title=\"新建信件\"\n    :before-close=\"handleClose\"\n    :visible.sync=\"formDialogVisible\"\n    direction=\"rtl\"\n    size=\"50%\"\n    custom-class=\"demo-drawer\"\n    ref=\"drawer\"\n    >\n      <div class=\"drawer__content\">\n        <el-form :model=\"form\" label-position=\"left\">\n          <el-row :gutter=\"28\">\n            <el-col>\n              <el-form-item label=\"内容\" style=\"margin: 10px 10px 10px 10px;\">\n                <el-input type=\"textarea\" resize=\"none\" :rows=\"10\" v-model=\"form.context\" autocomplete=\"off\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n          <el-divider></el-divider>\n          <el-row :gutter=\"28\">\n            <el-col :span=\"12\">\n              <el-form-item label=\"用户名\" label-width=\"100px\" style=\"margin: 10px 10px 10px 10px;\">\n                <el-input v-model=\"form.username\" autocomplete=\"off\"></el-input>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"12\">\n              <el-form-item label=\"联系方式\" label-width=\"100px\" style=\"margin: 10px 10px 10px 10px;\">\n                <el-input v-model=\"form.callPhone\" autocomplete=\"off\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n          <el-row :gutter=\"28\">\n            <el-col :span=\"12\">\n              <el-form-item label=\"收件方\" label-width=\"100px\" style=\"margin: 10px 10px 10px 10px;\">\n                <el-input v-model=\"form.receiver\" autocomplete=\"off\"></el-input>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"12\">\n              <el-form-item label=\"联系方式\" label-width=\"100px\" style=\"margin: 10px 10px 10px 10px;\">\n                <el-input v-model=\"form.receiverPhone\" autocomplete=\"off\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n          <el-divider></el-divider>\n          <el-row :gutter=\"28\">\n            <el-col>\n              <el-form-item label=\"源地址\" label-width=\"75px\" style=\"margin: 10px 10px 10px 10px;\">\n                <el-input v-model=\"form.fromAddress\" autocomplete=\"off\" placeholder=\"电子信件默认为邮箱\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n          <el-row :gutter=\"28\">\n            <el-col>\n              <el-form-item label=\"目的地址\" label-width=\"75px\" style=\"margin: 10px 10px 10px 10px;\">\n                <el-input v-model=\"form.toAddress\" autocomplete=\"off\" placeholder=\"电子信件默认为邮箱\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n          <el-row :gutter=\"10\">\n            <el-col :span=\"10\">\n              <el-form-item label=\"邮编\" label-width=\"75px\" style=\"margin: 10px 10px 10px 10px;\">\n                <el-input v-model=\"form.postalCode\" autocomplete=\"off\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n        </el-form>\n        <div class=\"demo-drawer__footer\">\n          <el-button @click=\"cancelForm\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"$refs.drawer.closeDrawer()\" :loading=\"loading\">{{ loading ? '提交中 ...' : '确 定' }}</el-button>\n        </div>\n      </div>\n    </el-drawer>\n  </div>\n</template>\n\n<script>\nimport { getToken } from '@/utils/auth';\nexport default {\n  name: \"TextView\",\n  data() {\n    return {\n      username: \"\",\n      tableData: [],\n      pageNum: 1,\n      pageSize: 10,\n      total: 0,\n      textDialogVisible: false,\n      loading: false,\n      formDialogVisible: false,\n      timer: null,\n      letter: {},\n      token: {\n        Authorization: getToken()\n      },\n      form: {\n        status: 2\n      }\n    }\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    load() {\n      this.axios.get(\"/letter/page\", {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.tableData = result.data.page;\n          this.total = result.data.total;\n        } else {\n          this.$message.error(result.msg);\n        }\n      })\n    },\n    search() {\n      this.axios.get(\"/letter/page\", {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          username: this.username\n        }\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.tableData = result.data.page;\n          this.total = result.data.total;\n        } else {\n          this.$message.error(result.msg);\n        }\n      })\n    },\n    reset() {\n      this.username = \"\";\n      this.total = 0;\n      this.pageNum = 1;\n      this.pageSize = 10;\n      this.load();\n    },\n    newLetter() {\n      this.formDialogVisible = true;\n    },\n    handleView(data) {\n      this.textDialogVisible = true;\n      this.letter = data;\n    },\n    download(url) {\n      window.open(url);\n    },\n    handleSizeChange(pageSize) {\n      this.pageSize = pageSize;\n      this.load();\n    },\n    handleCurrentChange(pageNum) {\n      this.pageNum = pageNum;\n      this.load();\n    },\n    handleClose() {\n      if (this.loading) {\n        return;\n      }\n      this.$confirm('确定要提交表单吗？')\n        .then(_ => {\n          this.loading = true;\n          this.axios.post(\"/letter/add\", this.form).then(res => {\n              let result = res.data;\n              if (result.code === 'C200') {\n                this.$message.success(\"添加成功\");\n                this.load();\n              } else {\n                this.$message.error(result.msg);\n              }\n            });\n          this.timer = setTimeout(() => {\n            // 动画关闭需要一定的时间\n            setTimeout(() => {\n              this.loading = false;\n            }, 400);\n          }, 2000);\n          this.formDialogVisible = false;\n        })\n        .catch(_ => {});\n    },\n    cancelForm() {\n      this.loading = false;\n      this.formDialogVisible = false;\n      clearTimeout(this.timer);\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"less\">\n@import \"../../assets/font/font.css\";\n\n.zh_CN_1 {\n  font-family: coki;\n  font-size: 25px;\n}\n.zh_CN_2 {\n  font-family: WCF;\n  font-size: 25px;\n}\n\n.zh_CN_3 {\n  font-family: WF;\n  font-size: 25px;\n}\n\n.en_US_4 {\n  font-family: willion;\n  font-size: 25px;\n}\n\n.en_US_5 {\n  font-family: family;\n  font-size: 25px;\n}\n\n.en_US_6 {\n  font-family: romeobohemian;\n  font-size: 25px;\n}\n</style>\n"],"mappings":"AA0MA,SAAAA,QAAA;AACA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,QAAA;MACAC,SAAA;MACAC,OAAA;MACAC,QAAA;MACAC,KAAA;MACAC,iBAAA;MACAC,OAAA;MACAC,iBAAA;MACAC,KAAA;MACAC,MAAA;MACAC,KAAA;QACAC,aAAA,EAAAd,QAAA;MACA;MACAe,IAAA;QACAC,MAAA;MACA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,IAAA;EACA;EACAC,OAAA;IACAD,KAAA;MACA,KAAAE,KAAA,CAAAC,GAAA;QACAC,MAAA;UACAjB,OAAA,OAAAA,OAAA;UACAC,QAAA,OAAAA;QACA;MACA,GAAAiB,IAAA,CAAAC,GAAA;QACA,IAAAC,MAAA,GAAAD,GAAA,CAAAtB,IAAA;QACA,IAAAuB,MAAA,CAAAC,IAAA;UACA,KAAAtB,SAAA,GAAAqB,MAAA,CAAAvB,IAAA,CAAAyB,IAAA;UACA,KAAApB,KAAA,GAAAkB,MAAA,CAAAvB,IAAA,CAAAK,KAAA;QACA;UACA,KAAAqB,QAAA,CAAAC,KAAA,CAAAJ,MAAA,CAAAK,GAAA;QACA;MACA;IACA;IACAC,OAAA;MACA,KAAAX,KAAA,CAAAC,GAAA;QACAC,MAAA;UACAjB,OAAA,OAAAA,OAAA;UACAC,QAAA,OAAAA,QAAA;UACAH,QAAA,OAAAA;QACA;MACA,GAAAoB,IAAA,CAAAC,GAAA;QACA,IAAAC,MAAA,GAAAD,GAAA,CAAAtB,IAAA;QACA,IAAAuB,MAAA,CAAAC,IAAA;UACA,KAAAtB,SAAA,GAAAqB,MAAA,CAAAvB,IAAA,CAAAyB,IAAA;UACA,KAAApB,KAAA,GAAAkB,MAAA,CAAAvB,IAAA,CAAAK,KAAA;QACA;UACA,KAAAqB,QAAA,CAAAC,KAAA,CAAAJ,MAAA,CAAAK,GAAA;QACA;MACA;IACA;IACAE,MAAA;MACA,KAAA7B,QAAA;MACA,KAAAI,KAAA;MACA,KAAAF,OAAA;MACA,KAAAC,QAAA;MACA,KAAAY,IAAA;IACA;IACAe,UAAA;MACA,KAAAvB,iBAAA;IACA;IACAwB,WAAAhC,IAAA;MACA,KAAAM,iBAAA;MACA,KAAAI,MAAA,GAAAV,IAAA;IACA;IACAiC,SAAAC,GAAA;MACAC,MAAA,CAAAC,IAAA,CAAAF,GAAA;IACA;IACAG,iBAAAjC,QAAA;MACA,KAAAA,QAAA,GAAAA,QAAA;MACA,KAAAY,IAAA;IACA;IACAsB,oBAAAnC,OAAA;MACA,KAAAA,OAAA,GAAAA,OAAA;MACA,KAAAa,IAAA;IACA;IACAuB,YAAA;MACA,SAAAhC,OAAA;QACA;MACA;MACA,KAAAiC,QAAA,cACAnB,IAAA,CAAAoB,CAAA;QACA,KAAAlC,OAAA;QACA,KAAAW,KAAA,CAAAwB,IAAA,qBAAA7B,IAAA,EAAAQ,IAAA,CAAAC,GAAA;UACA,IAAAC,MAAA,GAAAD,GAAA,CAAAtB,IAAA;UACA,IAAAuB,MAAA,CAAAC,IAAA;YACA,KAAAE,QAAA,CAAAiB,OAAA;YACA,KAAA3B,IAAA;UACA;YACA,KAAAU,QAAA,CAAAC,KAAA,CAAAJ,MAAA,CAAAK,GAAA;UACA;QACA;QACA,KAAAnB,KAAA,GAAAmC,UAAA;UACA;UACAA,UAAA;YACA,KAAArC,OAAA;UACA;QACA;QACA,KAAAC,iBAAA;MACA,GACAqC,KAAA,CAAAJ,CAAA;IACA;IACAK,WAAA;MACA,KAAAvC,OAAA;MACA,KAAAC,iBAAA;MACAuC,YAAA,MAAAtC,KAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}