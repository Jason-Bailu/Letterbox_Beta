{"ast":null,"code":"export default {\n  name: \"RoleView\",\n  data() {\n    return {\n      roleName: \"\",\n      description: \"\",\n      tableData: [],\n      pageNum: 1,\n      pageSize: 5,\n      total: 0,\n      dialogFormVisible: false,\n      dialogMenuVisible: false,\n      form: {},\n      multipleSelection: [],\n      menuData: [],\n      defaultProps: {\n        label: 'name',\n        children: 'children'\n      },\n      roleId: null,\n      expends: [],\n      checkeds: []\n    };\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    load() {\n      this.axios.get(\"role/page\", {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.tableData = result.data.page;\n          this.total = result.data.total;\n        } else this.$message.error(result.msg);\n      });\n    },\n    search() {\n      this.axios.get(\"/role/find\", {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          roleName: this.roleName,\n          description: this.description\n        }\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.tableData = result.data.page;\n          this.total = result.data.total;\n        } else {\n          this.$message.error(result.msg);\n        }\n      });\n    },\n    reset() {\n      this.total = 0;\n      this.pageNum = 1;\n      this.pageSize = 5;\n      this.roleName = \"\";\n      this.description = \"\";\n      this.load();\n    },\n    handleAdd() {\n      this.dialogFormVisible = true;\n      this.form = {};\n    },\n    save() {\n      this.axios.post(\"/role/save\", this.form).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.$message.success(\"保存成功\");\n          this.dialogFormVisible = false;\n          this.load();\n        } else {\n          this.$message.error(result.msg);\n        }\n      });\n    },\n    saveRoleMenu() {},\n    handleMenu(id) {\n      this.dialogMenuVisible = true;\n      this.axios.get(\"/menu/all\").then(res => {\n        let result = res.data;\n        this.menuData = result.data;\n        this.expends = this.menuData.map(v => v.id);\n      });\n    },\n    handleEdit(row) {\n      this.form = Object.assign({}, row);\n      this.dialogFormVisible = true;\n    },\n    handleSelectionChange(val) {\n      this.multipleSelection = val;\n    },\n    delBatch() {\n      let ids = this.multipleSelection.map(v => v.id);\n      this.axios.post(\"/role/batchDelete\", ids).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.$message.success(\"批量删除成功\");\n          this.load();\n        } else {\n          this.$message.error(result.msg);\n        }\n      });\n    },\n    handleDelete(id) {\n      this.axios.delete(\"/role/delete\", {\n        params: {\n          id: id\n        }\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.$message.success(\"删除成功\");\n          this.load();\n        } else {\n          this.$message.error(result.msg);\n        }\n      });\n    },\n    handleSizeChange(pageSize) {\n      console.log(pageSize);\n      this.pageSize = pageSize;\n      if (this.roleName != \"\" || this.description != \"\") {\n        this.search();\n      } else {\n        this.load();\n      }\n    },\n    handleCurrentChange(pageNum) {\n      console.log(pageNum);\n      this.pageNum = pageNum;\n      if (this.roleName != \"\" || this.description != \"\") {\n        this.search();\n      } else {\n        this.load();\n      }\n    }\n  }\n};","map":{"version":3,"names":["name","data","roleName","description","tableData","pageNum","pageSize","total","dialogFormVisible","dialogMenuVisible","form","multipleSelection","menuData","defaultProps","label","children","roleId","expends","checkeds","created","load","methods","axios","get","params","then","res","result","code","page","$message","error","msg","search","reset","handleAdd","save","post","success","saveRoleMenu","handleMenu","id","map","v","handleEdit","row","Object","assign","handleSelectionChange","val","delBatch","ids","handleDelete","delete","handleSizeChange","console","log","handleCurrentChange"],"sources":["src/views/systemview/RoleView.vue"],"sourcesContent":["<template>\n  <div>\n    <div style=\"margin: 10px 0\">\n      <el-input style=\"width: 200px; margin-left: 5px\" suffix-icon=\"el-icon-search\" placeholder=\"请输入名称\" v-model=\"roleName\"></el-input>\n      <el-input style=\"width: 200px; margin-left: 5px\" suffix-icon=\"el-icon-document\" placeholder=\"请输入描述\" v-model=\"description\"></el-input>\n      <el-button style=\"margin-left: 5px\" type=\"primary\" @click=\"search\">搜索</el-button>\n      <el-button style=\"margin-left: 5px\" type=\"warning\" @click=\"reset\">重置</el-button>\n      <el-button style=\"margin-left: 5px\" type=\"primary\" @click=\"handleAdd\">新增<i class=\"el-icon-circle-plus-outline\" style=\"margin-left: 5px\"></i></el-button>\n      <el-popconfirm\n          confirm-button-text='好的'\n          cancel-button-text='不用了'\n          icon=\"el-icon-info\"\n          icon-color=\"red\"\n          title=\"确定批量删除吗？\"\n          @confirm=\"delBatch\">\n        <el-button style=\"margin-left: 5px\" type=\"danger\" slot=\"reference\">批量删除<i class=\"el-icon-remove-outline\" style=\"margin-left: 5px\"></i></el-button>\n      </el-popconfirm>\n    </div>\n    <el-table\n        :data=\"tableData\"\n        height=\"60vh\"\n        style=\"width: 100%; border-radius: 10px\"\n        @selection-change=\"handleSelectionChange\">\n      <el-table-column type=\"selection\" width=\"55\"/>\n      <el-table-column prop=\"id\" label=\"ID\" width=\"55\"/>\n      <el-table-column prop=\"roleName\" label=\"角色名\"/>\n      <el-table-column prop=\"level\" label=\"等级\"/>\n      <el-table-column prop=\"description\" label=\"描述\"/>\n      <el-table-column prop=\"menus\" label=\"权限配置\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"info\" @click=\"handleMenu(scope.row.id)\">分配菜单/权限<i class=\"el-icon-menu\"></i></el-button>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"option\" label=\"操作\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"success\" @click=\"handleEdit(scope.row)\">编辑</el-button>\n          <el-popconfirm\n              confirm-button-text='好的'\n              cancel-button-text='不用了'\n              icon=\"el-icon-info\"\n              icon-color=\"red\"\n              title=\"确定删除吗？\"\n              @confirm=\"handleDelete(scope.row.id)\">\n            <el-button type=\"danger\" slot=\"reference\" style=\"margin-left: 5px\">删除</el-button>\n          </el-popconfirm>\n        </template>\n      </el-table-column>\n    </el-table>\n    <div style=\"padding: 10px 0\">\n      <el-pagination\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n          :current-page=\"pageNum\"\n          :page-size=\"pageSize\"\n          :page-sizes=\"[2, 5, 10, 15]\"\n          :total=\"total\"\n          layout=\"total, sizes, prev, pager, next, jumper\">\n      </el-pagination>\n    </div>\n    <el-dialog title=\"角色信息\" :visible.sync=\"dialogFormVisible\" width=\"30%\">\n      <el-form :model=\"form\" label-width=\"100px\" size=\"small\">\n        <el-form-item label=\"名称\">\n          <el-input v-model=\"form.roleName\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"等级\">\n          <el-input v-model=\"form.level\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"描述\">\n          <el-input v-model=\"form.description\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"save\">确 定</el-button>\n      </div>\n    </el-dialog>\n    <el-dialog title=\"菜单分配\" :visible.sync=\"dialogMenuVisible\" width=\"30%\">\n      <el-tree\n          :data=\"menuData\"\n          show-checkbox\n          node-key=\"id\"\n          ref=\"tree\"\n          :default-expanded-keys=\"expends\"\n          :default-checked-keys=\"checkeds\"\n          :props=\"defaultProps\">\n        <span class=\"custom-tree-node\" slot-scope=\"{data}\">\n          <span><i :class=\"data.icon\"/>{{ data.name }}</span>\n        </span>\n      </el-tree>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogMenuVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"saveRoleMenu\">确 定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"RoleView\",\n  data() {\n    return {\n      roleName: \"\",\n      description: \"\",\n      tableData: [],\n      pageNum: 1,\n      pageSize: 5,\n      total: 0,\n      dialogFormVisible: false,\n      dialogMenuVisible: false,\n      form: {},\n      multipleSelection: [],\n      menuData: [],\n      defaultProps: {\n        label: 'name',\n        children: 'children'\n      },\n      roleId: null,\n      expends: [],\n      checkeds: []\n\n    }\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    load() {\n      this.axios.get(\"role/page\", {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        let result = res.data\n        if (result.code === 'C200') {\n          this.tableData = result.data.page\n          this.total = result.data.total\n        } else (\n          this.$message.error(result.msg)\n        )\n      })\n    },\n    search() {\n      this.axios.get(\"/role/find\", {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          roleName: this.roleName,\n          description: this.description\n        }\n      }).then(res => {\n        let result = res.data\n        if (result.code === 'C200') {\n          this.tableData = result.data.page\n          this.total = result.data.total\n        } else {\n          this.$message.error(result.msg)\n        }\n      })\n    },\n    reset() {\n      this.total = 0\n      this.pageNum = 1\n      this.pageSize = 5\n      this.roleName = \"\"\n      this.description = \"\"\n      this.load()\n    },\n    handleAdd() {\n      this.dialogFormVisible = true\n      this.form = {}\n    },\n    save() {\n      this.axios.post(\"/role/save\", this.form).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.$message.success(\"保存成功\")\n          this.dialogFormVisible = false\n          this.load()\n        } else {\n          this.$message.error(result.msg)\n        }\n      })\n    },\n    saveRoleMenu() {\n\n    },\n    handleMenu(id) {\n      this.dialogMenuVisible = true\n      this.axios.get(\"/menu/all\").then(res => {\n        let result = res.data\n        this.menuData = result.data\n        this.expends = this.menuData.map(v => v.id)\n      })\n    },\n    handleEdit(row) {\n      this.form = Object.assign({}, row)\n      this.dialogFormVisible = true\n    },\n    handleSelectionChange(val) {\n      this.multipleSelection = val;\n    },\n    delBatch() {\n      let ids = this.multipleSelection.map(v => v.id)\n      this.axios.post(\"/role/batchDelete\", ids).then(res => {\n        let result = res.data\n        if (result.code === 'C200') {\n          this.$message.success(\"批量删除成功\")\n          this.load()\n        } else {\n          this.$message.error(result.msg)\n        }\n      })\n    },\n    handleDelete(id) {\n      this.axios.delete(\"/role/delete\", {\n        params: {\n          id: id\n        }\n      }).then(res => {\n        let result = res.data\n        if (result.code === 'C200') {\n          this.$message.success(\"删除成功\")\n          this.load()\n        } else {\n          this.$message.error(result.msg)\n        }\n      })\n    },\n    handleSizeChange(pageSize) {\n      console.log(pageSize);\n      this.pageSize = pageSize;\n      if (this.roleName != \"\" || this.description != \"\") {\n        this.search();\n      } else {\n        this.load();\n      }\n    },\n    handleCurrentChange(pageNum) {\n      console.log(pageNum);\n      this.pageNum = pageNum;\n      if (this.roleName != \"\" || this.description != \"\") {\n        this.search();\n      } else {\n        this.load();\n      }\n    }\n  }\n}\n</script>\n\n<style>\n\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}