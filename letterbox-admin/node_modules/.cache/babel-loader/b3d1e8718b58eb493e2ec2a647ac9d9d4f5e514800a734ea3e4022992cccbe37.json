{"ast":null,"code":"import { getToken } from '@/utils/auth';\nexport default {\n  name: \"CategoryView\",\n  data() {\n    return {\n      categoryData: [],\n      categoryName: \"\",\n      tableData: [],\n      pageNum: 1,\n      pageSize: 5,\n      total: 0,\n      dialogVisible: false,\n      form: {},\n      token: {\n        Authorization: getToken()\n      }\n    };\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    load() {\n      this.axios.get(\"/category/all\").then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.categoryData = result.data;\n        } else {\n          this.$message.error(result.msg);\n        }\n      });\n      this.axios.get(\"/good/page\", {\n        params: {\n          categoryName: this.categoryName,\n          pageNum: this.pageNum,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.tableData = result.data.page;\n          this.total = result.data.total;\n        } else {\n          this.$message.error(result.msg);\n        }\n      });\n    },\n    handleCheck(row) {\n      this.categoryName = row.className;\n      this.axios.get(\"/good/find/\" + this.categoryName, {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.tableData = result.data.page;\n          this.total = result.data.total;\n        } else {\n          this.$message.error(result.msg);\n        }\n      });\n    },\n    handleAdd(row) {\n      this.dialogVisible = true;\n      this.form = {};\n      this.form.className = row.className;\n    },\n    handleEdit(row) {\n      this.dialogVisible = true;\n      this.form = row;\n      console.log(this.form.id);\n    },\n    handleDelete(row) {\n      this.axios.post(\"/good/delete\", {\n        id: row.id,\n        className: row.className\n      }).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.$message.success(result.msg);\n          this.load();\n        } else {\n          this.$message.error(result.msg);\n        }\n      }).catch(error => {\n        this.$message.error(error.response.data.msg);\n      });\n    },\n    handleImageSuccess(res) {\n      this.form.imageUrl = res.data;\n    },\n    handleUpdate() {\n      this.axios.post(\"/good/update\", this.form).then(res => {\n        let result = res.data;\n        if (result.code === 'C200') {\n          this.$message.success(result.msg);\n          this.load();\n        } else {\n          this.$message.error(result.msg);\n        }\n      }).catch(error => {\n        this.$message.error(error.response.data.msg);\n      });\n      this.dialogVisible = false;\n    },\n    handleSizeChange(pageSize) {\n      this.pageSize = pageSize;\n      this.load();\n    },\n    handleCurrentChange(pageNum) {\n      this.pageNum = pageNum;\n      this.load();\n    }\n  }\n};","map":{"version":3,"names":["getToken","name","data","categoryData","categoryName","tableData","pageNum","pageSize","total","dialogVisible","form","token","Authorization","created","load","methods","axios","get","then","res","result","code","$message","error","msg","params","page","handleCheck","row","className","handleAdd","handleEdit","console","log","id","handleDelete","post","success","catch","response","handleImageSuccess","imageUrl","handleUpdate","handleSizeChange","handleCurrentChange"],"sources":["src/views/shopview/CategoryView.vue"],"sourcesContent":["<template>\n  <div>\n    <el-table\n        :data=\"categoryData\"\n        style=\"width: 100%; border-radius: 10px\">\n        <el-table-column prop=\"className\" label=\"类别\" align=\"center\"/>\n        <el-table-column label=\"图标\" align=\"center\">\n            <template slot-scope=\"scope\">\n            <i :class=\"scope.row.icon\" style=\"font-size: 20px\"/>\n            </template>\n        </el-table-column>\n        <el-table-column prop=\"count\" label=\"数量\" align=\"center\"/>\n        <el-table-column prop=\"option\" label=\"操作\" align=\"center\">\n            <template  slot-scope=\"scope\">\n                <el-button type=\"success\" @click=\"handleCheck(scope.row)\">查看</el-button>\n                <el-button type=\"success\" @click=\"handleAdd(scope.row)\">添加</el-button>\n            </template>\n        </el-table-column>\n    </el-table>\n    <el-divider></el-divider>\n    <el-card class=\"box-card\">\n        <el-table\n            :data=\"tableData\"\n            height=\"60vh\"\n            style=\"width: 100%; border-radius: 10px\">\n            <el-table-column prop=\"goodName\" label=\"名称\" align=\"center\"/>\n            <el-table-column prop=\"detail\" label=\"描述\" align=\"center\"/>\n            <el-table-column prop=\"className\" label=\"类别\" align=\"center\"/>\n            <el-table-column prop=\"repository\" label=\"库存\" align=\"center\"></el-table-column>\n            <el-table-column label=\"图片\" align=\"center\">\n                <template slot-scope=\"scope\">\n                    <el-image \n                        style=\"width: 100px; height: 100px\"\n                        :src=\"scope.row.imageUrl\" \n                        :preview-src-list=\"[scope.row.imageUrl]\">\n                    </el-image>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"操作\" align=\"center\">\n                <template  slot-scope=\"scope\">\n                    <el-button type=\"success\" @click=\"handleEdit(scope.row)\">编辑</el-button>\n                    <el-popconfirm\n                        confirm-button-text='好的'\n                        cancel-button-text='不用了'\n                        icon=\"el-icon-info\"\n                        icon-color=\"red\"\n                        title=\"确定删除吗？\"\n                        @confirm=\"handleDelete(scope.row)\">\n                        <el-button slot=\"reference\" style=\"margin-left: 5px\" type=\"danger\">删除</el-button>\n                    </el-popconfirm>\n                </template>\n            </el-table-column>\n        </el-table>\n        <div style=\"padding: 10px 0\">\n            <el-pagination\n                @size-change=\"handleSizeChange\"\n                @current-change=\"handleCurrentChange\"\n                :current-page=\"pageNum\"\n                :page-size=\"pageSize\"\n                :page-sizes=\"[5, 10, 15]\"\n                :total=\"total\"\n                layout=\"total, sizes, prev, pager, next, jumper\">\n            </el-pagination>\n        </div>\n    </el-card>\n    <el-dialog\n            title=\"更新\"\n            :visible.sync=\"dialogVisible\"\n            width=\"50%\"\n            center>\n            <el-form :model=\"form\" label-width=\"100px\" size=\"small\">\n            <el-row :gutter=\"30\">\n                <el-col :span=\"20\">\n                    <el-form-item label=\"图片\">\n                        <el-upload\n                            class=\"avatar-uploader\"\n                            action=\"http://localhost:9090/letterbox-api/file/upload\"\n                            :show-file-list=\"false\"\n                            :headers=\"token\"\n                            :on-success=\"handleImageSuccess\">\n                            <el-image v-if=\"form.imageUrl\" :src=\"form.imageUrl\" style=\"width: 200px; height: 200px;\" fit=\"fill\"/>\n                            <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n                        </el-upload>\n                    </el-form-item>\n                </el-col>\n                <el-col :span=\"10\">\n                    <el-form-item label=\"ID\" v-show=\"false\">\n                        <el-input v-model=\"form.id\" autocomplete=\"off\"></el-input>\n                    </el-form-item>\n                        <el-form-item label=\"名称\">\n                    <el-input v-model=\"form.goodName\" autocomplete=\"off\"></el-input>\n                        </el-form-item>\n                    <el-form-item label=\"描述\">\n                        <el-input v-model=\"form.detail\" autocomplete=\"off\"></el-input>\n                    </el-form-item>\n                    <el-form-item label=\"类别\">\n                        <el-select clearable v-model=\"form.className\" placeholder=\"请选择类别\" style=\"width: 100%\">\n                            <el-option v-for=\"item in categoryData\" :key=\"item.className\" :label=\"item.className\" :value=\"item.className\"></el-option>\n                        </el-select>\n                    </el-form-item>\n                    <el-form-item label=\"库存\">\n                        <div v-if=\"form.className == 'ink'\">\n                            <el-input-number v-model=\"form.repository\" :min=\"1\" :max=\"1\" :disabled=\"true\"></el-input-number></div>\n                        <div v-else-if=\"form.goodName == 'electronic'\">\n                            <el-input-number v-model=\"form.repository\" :min=\"1\"  :max=\"1\" :disabled=\"true\"></el-input-number></div>\n                        <div v-else-if=\"form.goodName == 'electroenve'\">\n                            <el-input-number v-model=\"form.repository\" :min=\"1\"  :max=\"1\" :disabled=\"true\"></el-input-number></div>\n                        <div v-else>\n                            <el-input-number v-model=\"form.repository\" :min=\"0\" :max=\"99\"></el-input-number>\n                        </div>\n                    </el-form-item>\n                </el-col>\n            </el-row>\n        </el-form>\n        <span slot=\"footer\" class=\"dialog-footer\">\n            <el-button @click=\"dialogVisible = false\">取 消</el-button>\n            <el-button type=\"primary\" @click=\"handleUpdate\">确 定</el-button>\n        </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { getToken } from '@/utils/auth';\n\nexport default {\n    name: \"CategoryView\",\n    data() {\n        return {\n            categoryData: [],\n            categoryName: \"\",\n            tableData: [],\n            pageNum: 1,\n            pageSize: 5,\n            total: 0,\n            dialogVisible: false,\n            form: {},\n            token: {\n                Authorization: getToken()\n            }\n        }\n    },\n    created() {\n        this.load();\n    },\n    methods: {\n        load() {\n            this.axios.get(\"/category/all\").then(res => {\n                let result = res.data;\n                if (result.code === 'C200') {\n                    this.categoryData = result.data;\n                } else {\n                    this.$message.error(result.msg);\n                }\n            })\n            this.axios.get(\"/good/page\", {\n                params: {\n                    categoryName: this.categoryName,\n                    pageNum: this.pageNum,\n                    pageSize: this.pageSize \n                }\n            }).then(res => {\n                let result = res.data;\n                if (result.code === 'C200') {\n                    this.tableData = result.data.page;\n                    this.total = result.data.total;\n                } else {\n                    this.$message.error(result.msg);\n                }\n            })\n        },\n        handleCheck(row) {\n            this.categoryName = row.className;\n            this.axios.get(\"/good/find/\"+this.categoryName, {\n                params: {\n                   pageNum: this.pageNum,\n                   pageSize: this.pageSize \n                }\n            }).then(res => {\n                let result = res.data;\n                if (result.code === 'C200') {\n                    this.tableData = result.data.page;\n                    this.total = result.data.total;\n                } else {\n                    this.$message.error(result.msg);\n                }\n            })\n        },\n        handleAdd(row) {\n            this.dialogVisible = true;\n            this.form = {};\n            this.form.className = row.className;\n        },\n        handleEdit(row) {\n            this.dialogVisible = true;\n            this.form = row;\n            console.log(this.form.id);\n        },\n        handleDelete(row) {\n            this.axios.post(\"/good/delete\", {\n                id: row.id,\n                className: row.className\n            }).then(res => {\n                let result = res.data;\n                if (result.code === 'C200') {\n                    this.$message.success(result.msg);\n                    this.load();\n                } else {\n                    this.$message.error(result.msg);\n                }\n            }).catch(error => {\n                this.$message.error(error.response.data.msg);\n            })\n        },\n        handleImageSuccess(res) {\n            this.form.imageUrl = res.data;\n        },\n        handleUpdate() {\n            this.axios.post(\"/good/update\", this.form).then(res => {\n                let result = res.data;\n                if (result.code === 'C200') {\n                    this.$message.success(result.msg);\n                    this.load();\n                } else {\n                    this.$message.error(result.msg);\n                }\n            }).catch(error => {\n                this.$message.error(error.response.data.msg);\n            })\n            this.dialogVisible = false;\n        },\n        handleSizeChange(pageSize) {\n            this.pageSize = pageSize;\n            this.load();\n        },\n        handleCurrentChange(pageNum) {\n            this.pageNum = pageNum;\n            this.load();\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}